var b=(x,d,r)=>new Promise((l,p)=>{var t=n=>{try{u(r.next(n))}catch(c){p(c)}},g=n=>{try{u(r.throw(n))}catch(c){p(c)}},u=n=>n.done?l(n.value):Promise.resolve(n.value).then(t,g);u((r=r.apply(x,d)).next())});import{a as T,I as h,c as $,b as P,m as U,r as w,p as A,f as K,l as e,o as V,i as q,w as R,v as I,k as s,q as a,s as v,t as _,B as L,x as O,F as G,y as W}from"./index.00d33503.js";import{C as j}from"./index.529bcea0.js";/* empty css              */import"./index.9930c332.js";import{u as H,a as J,L as D,_ as Q,b as X}from"./LoginFormTitle.e3f9fe6f.js";import{F as E}from"./Form.a07840f9.js";import{C as Y,R as Z}from"./index.3c785eed.js";import"./_baseIteratee.4ef64ccd.js";import"./get.b7869e81.js";import"./useSize.17f6a0ab.js";const me=T({__name:"LoginForm",setup(x){const d=Y,r=Z,l=E.Item,p=h.Password,{t}=$(),{notification:g,createErrorModal:u}=W(),{prefixCls:n}=P("login"),c=U(),{setLoginState:z,getLoginState:B}=H(),{getFormRules:M}=J(),S=w(),y=w(!1),k=w(!1),m=A({account:"admin",password:"123456"}),{validForm:N}=X(S),C=K(()=>e(B)===D.LOGIN);function F(){return b(this,null,function*(){const f=yield N();if(!!f)try{y.value=!0;const o=yield c.login({password:f.password,username:f.account,mode:"none"});o&&g.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${o.realName}`,duration:3})}catch(o){u({title:t("sys.api.errorTip"),content:o.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{y.value=!1}})}return(f,o)=>(V(),q(G,null,[R(s(Q,{class:"enter-x"},null,512),[[I,e(C)]]),R(s(e(E),{class:"p-4 enter-x",model:m,rules:e(M),ref_key:"formRef",ref:S,onKeypress:O(F,["enter"])},{default:a(()=>[s(e(l),{name:"account",class:"enter-x"},{default:a(()=>[s(e(h),{size:"large",value:m.account,"onUpdate:value":o[0]||(o[0]=i=>m.account=i),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(l),{name:"password",class:"enter-x"},{default:a(()=>[s(e(p),{size:"large",visibilityToggle:"",value:m.password,"onUpdate:value":o[1]||(o[1]=i=>m.password=i),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(r),{class:"enter-x"},{default:a(()=>[s(e(d),{span:12},{default:a(()=>[s(e(l),null,{default:a(()=>[s(e(j),{checked:k.value,"onUpdate:checked":o[2]||(o[2]=i=>k.value=i),size:"small"},{default:a(()=>[v(_(e(t)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(d),{span:12},{default:a(()=>[s(e(l),{style:{"text-align":"right"}},{default:a(()=>[s(e(L),{type:"link",size:"small",onClick:o[3]||(o[3]=i=>e(z)(e(D).RESET_PASSWORD))},{default:a(()=>[v(_(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(l),{class:"enter-x"},{default:a(()=>[s(e(L),{type:"primary",size:"large",block:"",onClick:F,loading:y.value},{default:a(()=>[v(_(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[I,e(C)]])],64))}});export{me as default};
